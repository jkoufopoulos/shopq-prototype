# ShopQ Runtime Policy Configuration
# Runtime knobs for classification, verification, and quality monitoring.
# These values are referenced from code and documentation.
# For behavioral constraints (coverage %, diff size, workflow), see /claude.md.

classification:
  # Minimum confidence for email type classification
  # Below this threshold → "Uncategorized"
  # Strategy: Lower gate (0.70) + verify almost everything (0.50-0.94) = higher accuracy
  min_type_conf: 0.70

  # Minimum confidence for domain/attention labels
  # Below this threshold → label not applied
  min_label_conf: 0.70

  # Mapper thresholds (must match above for consistency)
  type_gate: 0.70
  domain_gate: 0.70
  attention_gate: 0.70

  # Learning thresholds
  learning_min_confidence: 0.70
  user_correction_confidence: 0.95
  llm_rule_confidence: 0.85

  # LLM classifier internal thresholds
  domain_min_threshold: 0.60
  domain_boost_value: 0.70

verifier:
  # Verifier triggers for classifications in this confidence range
  # Low end: classifications below this always trigger verifier
  trigger_conf_min: 0.50

  # High end: classifications above this skip verifier (high confidence)
  trigger_conf_max: 0.90

  # Importance confidence threshold - trigger verifier if importance_conf below this
  # Catches uncertain time_sensitive vs routine classifications
  trigger_importance_conf_min: 0.80

  # Additional triggers (multi-purpose senders, contradictions, weak reasoning)
  # are defined in code logic, not here.

quality_monitor:
  # Minimum emails across sessions before triggering quality analysis
  # System analyzes when ≥ this many emails have been processed
  batch_min_emails: 25

  # Note: Currently also defined in .env as MIN_EMAILS_FOR_ANALYSIS
  # This YAML is canonical reference; .env takes precedence until migrated.

temporal_decay:
  # Phase 4 temporal decay thresholds for importance modulation
  # These control how event/deadline proximity affects resolved_importance

  # Grace period after event end before marking as expired
  # Events that ended ≤ grace_period ago are still shown
  grace_period_hours: 1

  # Active window: events starting within this window → critical
  # Example: meeting in 30min → critical (needs attention NOW)
  active_window_hours: 1

  # Upcoming horizon: events ≤ this far out → time_sensitive
  # Example: dinner tomorrow → time_sensitive (plan for it)
  upcoming_horizon_days: 7

  # Distant threshold: events > this far out → routine
  # Example: conference in 3 weeks → routine (note but don't prioritize)
  distant_threshold_days: 7

ops:
  # Daily cost cap in USD
  # Only if script-enforced; leave at default if unused.
  daily_cost_cap_usd: 0.50
