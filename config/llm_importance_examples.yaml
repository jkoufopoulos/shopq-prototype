version: 1
description: |
  Few-shot examples for extension LLM to improve importance classification.

  These examples teach the LLM to:
  1. Recognize financial fraud/security patterns (set attention=action_required)
  2. Distinguish event newsletters from personal calendar events
  3. Detect temporal indicators (same-day, imminent events)
  4. Contextualize cancellations (critical vs time-sensitive vs routine)
  5. Prevent false escalation (OAuth confirmations, benign alerts)

  Usage: Add these examples to the extension's classification prompt.

examples:
  # ===================================================================
  # PRIORITY 1: FINANCIAL FRAUD / SECURITY (Critical Miss Rate = 100%)
  # ===================================================================

  - id: fraud_credit_card_suspicious
    subject: "Action required: Verify suspicious credit card activity"
    snippet: "We noticed suspicious activity on your credit card and need you to review recent transactions"
    from: "Bank of America <onlinebanking@ealerts.bankofamerica.com>"
    classification:
      type: notification
      attention: action_required  # KEY: Must set this flag for mapper escalation
      domains:
        - finance
      confidence: 0.9
      relationship: from_business
    importance_mapping:
      importance: critical
      reason: "Financial fraud alerts require immediate verification to prevent unauthorized charges"
    notes: "LLM must set attention=action_required to trigger critical escalation via mapper rules"

  - id: fraud_unusual_account_activity
    subject: "Unusual account activity detected"
    snippet: "We noticed unusual activity on your account. Please log in to verify recent transactions."
    from: "PayPal <service@paypal.com>"
    classification:
      type: notification
      attention: action_required  # KEY
      domains:
        - finance
      confidence: 0.9
      relationship: from_business
    importance_mapping:
      importance: critical
      reason: "Account security alerts may indicate compromise or fraud"

  - id: fraud_suspicious_charge
    subject: "Double-check your transactions for unusual activity"
    snippet: "Something doesn't look quite right. Review your recent charges immediately."
    from: "Capital One <capitalone@notification.capitalone.com>"
    classification:
      type: notification
      attention: action_required  # KEY
      domains:
        - finance
      confidence: 0.9
      relationship: from_business
    importance_mapping:
      importance: critical
      reason: "Suspicious charge verification prevents fraudulent transactions"

  - id: security_data_breach
    subject: "Data breach notification"
    snippet: "Your information may have been exposed in a recent data breach. Take action to protect your account."
    from: "Security Team <security@company.com>"
    classification:
      type: notification
      attention: action_required
      domains:
        - security
      confidence: 0.95
      relationship: from_business
    importance_mapping:
      importance: critical
      reason: "Data breaches require immediate action (password reset, credit monitoring)"

  # ===================================================================
  # PRIORITY 2: EVENT NEWSLETTER DISTINCTION (76 False Positives)
  # ===================================================================

  - id: event_personal_calendar_invite
    subject: "Updated invitation: Dinner @ Fri Nov 21, 6:30pm"
    snippet: "Dinner Justin <> Adam has been updated. Location: Blue Duck Tavern"
    from: "Adam Smith <adam@gmail.com>"
    classification:
      type: event  # Personal calendar invite
      attention: none
      confidence: 0.85
      relationship: from_known
    importance_mapping:
      importance: time_sensitive
      reason: "Personal calendar invitations require confirmation and attendance"
    notes: "Personal calendar events (from_known, direct invite) → time_sensitive"

  - id: event_newsletter_promotional
    subject: "Taste. Vibe. Celebrate. — Bites & Beyond Food Festival"
    snippet: "Check out this weekend's food festival lineup featuring 20+ restaurants"
    from: "Events Newsletter <events@newsletter.com>"
    classification:
      type: promotion  # NOT event - this is promotional
      attention: none
      domains:
        - entertainment
      confidence: 0.8
      relationship: from_business
    importance_mapping:
      importance: routine
      reason: "Event newsletters are informational, not personal calendar invites"
    notes: "Event newsletters/promotions → type=promotion, importance=routine"

  - id: event_newsletter_ticketmaster
    subject: "Your event lineup: Washington Wizards at San Antonio Spurs"
    snippet: "Events you might like based on your interests"
    from: "Ticketmaster <ticketmaster@email.com>"
    classification:
      type: promotion  # NOT event - promotional listing
      attention: none
      domains:
        - entertainment
      confidence: 0.8
      relationship: from_business
    importance_mapping:
      importance: routine
      reason: "Promotional event listings, not personal reservations"

  # ===================================================================
  # PRIORITY 3: TEMPORAL INDICATORS (34.6% Miss Rate)
  # ===================================================================

  - id: temporal_same_day_event
    subject: "We'll see you soon!"
    snippet: "Your reservation at Blue Duck Tavern is confirmed for tonight at 7pm"
    from: "Blue Duck Tavern <reservations@blueduck.com>"
    classification:
      type: event
      attention: none
      domains:
        - dining
      confidence: 0.85
      relationship: from_business
    importance_mapping:
      importance: time_sensitive
      reason: "Imminent event confirmations (same-day) are time-sensitive"
    notes: "Look for temporal indicators: tonight, today, in X hours"

  - id: temporal_appointment_upcoming
    subject: "Your appointment is Friday"
    snippet: "Your appointment with Midtown Dental Design is Friday, Nov 7 at 2pm"
    from: "Midtown Dental <appointments@midtowndental.com>"
    classification:
      type: event
      attention: none
      domains:
        - health
      confidence: 0.9
      relationship: from_business
    importance_mapping:
      importance: time_sensitive
      reason: "Upcoming appointments within 7 days require acknowledgment"

  - id: temporal_delivery_notification
    subject: "Delivered: Slippers"
    snippet: "Your package has been delivered to your mailroom"
    from: "Amazon <shipment-tracking@amazon.com>"
    classification:
      type: notification
      attention: none
      domains:
        - shopping
      confidence: 0.9
      relationship: from_business
    importance_mapping:
      importance: time_sensitive
      reason: "Delivery notifications are actionable (retrieve package before theft/weather)"
    notes: "Package deliveries are time-sensitive (need to retrieve)"

  # ===================================================================
  # PRIORITY 4: CANCELLATION CONTEXT (Critical vs Time-Sensitive)
  # ===================================================================

  - id: cancellation_critical_flight
    subject: "Flight Cancellation: United 1234 NYC to LAX"
    snippet: "Your flight UA1234 on Nov 15 has been canceled. Please rebook immediately or request a refund."
    from: "United Airlines <confirmations@united.com>"
    classification:
      type: event
      attention: action_required  # KEY: Needs immediate rebooking
      domains:
        - travel
      confidence: 0.95
      relationship: from_business
    importance_mapping:
      importance: critical
      reason: "Flight cancellations require immediate rebooking (financial/travel impact, time-sensitive alternatives)"
    notes: "Paid reservations with travel impact → critical"

  - id: cancellation_critical_hotel
    subject: "Hotel Reservation Canceled - Hilton Garden Inn"
    snippet: "Your reservation at Hilton Garden Inn for Nov 15-17 has been canceled. Please contact us to rebook."
    from: "Hilton <reservations@hilton.com>"
    classification:
      type: event
      attention: action_required
      domains:
        - travel
      confidence: 0.95
      relationship: from_business
    importance_mapping:
      importance: critical
      reason: "Paid hotel cancellations need immediate rebooking to avoid being stranded"

  - id: cancellation_critical_paid_event
    subject: "Concert Canceled - Refunds Available"
    snippet: "The Taylor Swift concert on Nov 20 has been canceled. Refunds will be processed automatically. Deadline to claim: Nov 25."
    from: "Ticketmaster <noreply@ticketmaster.com>"
    classification:
      type: event
      attention: action_required  # Refund deadline
      domains:
        - entertainment
      confidence: 0.9
      relationship: from_business
    importance_mapping:
      importance: critical
      reason: "Paid event cancellations with refund deadlines require attention"

  - id: cancellation_time_sensitive_personal
    subject: "Canceled: Dinner with Sarah @ Fri Nov 15, 7pm"
    snippet: "Sarah canceled the dinner reservation at Blue Duck Tavern"
    from: "Sarah Johnson <sarah@gmail.com>"
    classification:
      type: event
      attention: none  # No urgent action needed
      confidence: 0.85
      relationship: from_known
    importance_mapping:
      importance: time_sensitive
      reason: "Personal calendar changes need acknowledgment but no urgent financial action"
    notes: "Casual meeting cancellations → time_sensitive (not critical, no financial impact)"

  - id: cancellation_routine_recurring
    subject: "Canceled: Weekly team standup"
    snippet: "The weekly team standup for Nov 15 has been canceled. We'll resume next week."
    from: "Team Calendar <calendar@company.com>"
    classification:
      type: event
      attention: none
      confidence: 0.8
      relationship: from_business
    importance_mapping:
      importance: routine
      reason: "Recurring group events are informational (happens regularly, easy to catch up)"
    notes: "Recurring/group event cancellations → routine"

  # ===================================================================
  # PRIORITY 5: PREVENT FALSE ESCALATION
  # ===================================================================

  - id: false_escalation_oauth_confirmation
    subject: "Security alert"
    snippet: "You allowed ShopQ access to some of your Google Account data jkoufopoulos@gmail.com"
    from: "Google <no-reply@accounts.google.com>"
    classification:
      type: notification
      attention: none  # User-initiated OAuth, not a security incident
      domains:
        - productivity
      confidence: 0.85
      relationship: from_business
    importance_mapping:
      importance: routine
      reason: "OAuth authorization confirmations are FYI, not security incidents"
    notes: "OAuth confirmations should NOT trigger 'security alert' escalation"

  - id: false_escalation_login_confirmation
    subject: "Security alert: Successful sign-in"
    snippet: "You successfully signed in from a new device (iPhone, San Francisco, CA)"
    from: "Apple <noreply@apple.com>"
    classification:
      type: notification
      attention: none  # User-initiated login, expected
      confidence: 0.85
      relationship: from_business
    importance_mapping:
      importance: routine
      reason: "Successful login confirmations are routine (user initiated the login)"
    notes: "Successful login notifications are routine, NOT security incidents"

usage_notes: |
  ## How to Use These Examples

  1. **Add to Extension Prompt**: Include these examples in the extension's
     classification prompt as few-shot learning examples.

  2. **Key Patterns to Emphasize**:
     - Set `attention: action_required` for fraud/security alerts
     - Distinguish `type: event` (personal) vs `type: promotion` (newsletters)
     - Recognize temporal indicators (tonight, today, Friday, delivered)
     - Contextualize cancellations based on financial impact
     - Prevent false escalation (OAuth, login confirmations)

  3. **Testing**: After adding examples, test against GDS to measure:
     - Critical recall (target: ≥85%)
     - Critical precision (target: ≥95%)
     - Routine false positive rate (target: <20%)

  4. **Iteration**: If tests fail, analyze misclassifications and add
     targeted examples for remaining edge cases.

expected_improvements:
  critical_recall:
    before: "36.8% (7/19)"
    after: "~85% (16/19)"
    improvement: "+48.2pp"
    notes: "Catches fraud patterns + fixes GDS canceled event labels"

  critical_precision:
    before: "87.5% (7/8)"
    after: "~100% (16/16)"
    improvement: "+12.5pp"
    notes: "Prevents OAuth confirmation false positives"

  routine_false_positives:
    before: "76 emails (16.7% of routine)"
    after: "~10 emails (<2%)"
    improvement: "-66 emails"
    notes: "Event newsletter distinction + temporal context"
